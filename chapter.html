<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter Viewer</title>
    <script>
        async function checkImageExists(url) {
            try {
                const response = await fetch(url);
                return response.ok; // true jika 200, false jika 404 atau error lainnya
            } catch (error) {
                return false; // Tangani jika ada error dalam fetching
            }
        }

        async function loadChapter() {
            // Mendapatkan hash dari URL untuk menentukan chapter
            const hash = window.location.hash.substring(1);

            const chapterContainer = document.getElementById('chapter-container');
            chapterContainer.innerHTML = `<h2>Loading chapter ${hash}...</h2>`;

            const baseUrl = `https://sv1.imgkc1.my.id/wp-content/img/T/Tsue-to-Tsurugi-no-Wistoria/`;
            const chapterFolder = hash.padStart(5, '0'); // Format chapter (misal: 01.1 -> 01.1)
            
            let page = 0; // Awal dari gambar 000

            // Loop terus sampai gambar tidak ditemukan
            while (true) {
                const imageUrl = `${baseUrl}${chapterFolder}/${page.toString().padStart(3, '0')}.jpg`;
                
                // Cek apakah gambar ada
                const imageExists = await checkImageExists(imageUrl);
                if (!imageExists) {
                    break; // Hentikan loop jika gambar tidak ditemukan (404)
                }

                // Buat elemen gambar jika ditemukan
                const img = document.createElement('img');
                img.src = imageUrl;
                img.alt = `Chapter ${hash} - Page ${page + 1}`;
                img.style.display = 'block'; // Menampilkan satu per satu gambar
                img.style.width = '100%'; // Sesuaikan ukuran gambar

                chapterContainer.appendChild(img);

                page++; // Lanjut ke gambar berikutnya
            }

            if (page === 0) {
                chapterContainer.innerHTML = `<h2>No images found for chapter ${hash}</h2>`;
            } else {
                chapterContainer.innerHTML += `<h2>End of Chapter ${hash}</h2>`;
            }
        }
    </script>
</head>
<body onload="loadChapter()">
    <h1>Chapter Viewer</h1>
    <div id="chapter-container"></div>
</body>
</html>
